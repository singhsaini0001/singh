"use strict";(self["webpackChunkdesktop_wallet"]=self["webpackChunkdesktop_wallet"]||[]).push([[276],{54907:function(e,t,s){s.d(t,{Z:function(){return d}});var i=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("transition",{attrs:{name:"fade"}},[i("div",{directives:[{name:"show",rawName:"v-show",value:e.showing,expression:"showing"}],staticClass:"fixed top-0 bottom-0 left-0 right-0 bg-black bg-opacity-40 flex items-center justify-center z-10"},[i("div",{staticClass:"mx-10 my-10 py-7 px-10 rounded-lg bg-modal w-full flex flex-col items-center max-w-screen-sm"},["success"===e.icon?i("img",{staticClass:"w-14 h-14 mb-6",attrs:{src:s(54398)}}):e._e(),e.title?i("div",{staticClass:"mb-4 text-xl font-bold"},[e._v(e._s(e.title))]):e._e(),e.message?i("div",{staticClass:"mb-6 text-center leading-5 text-dark-message text-base opacity-60"},[e._v(" "+e._s(e.message)+" ")]):e._e(),i("primary-button",{staticClass:"mt-2",attrs:{title:e.action},on:{click:e.runActionAndClose}})],1)])])},n=[],a=s(87307),r={components:{PrimaryButton:a.Z},props:{icon:{type:String,default:""}},data(){return{showing:!1,title:"",message:"",action:"",callback:null}},methods:{show(e,t,s,i){this.title=e,this.message=t,this.showing=!0,this.action=s||this.$t("general.dismiss"),this.callback=i},async runActionAndClose(){this.callback&&await this.callback(),this.showing=!1}}},l=r,o=s(1001),c=(0,o.Z)(l,i,n,!1,null,"221c3742",null),d=c.exports},33873:function(e,t,s){s.d(t,{Z:function(){return c}});var i=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"flex flex-row h-14 py-2 items-center px-4 active:brightness-75",on:{click:function(t){e.to?e.$router.push(e.to):e.$emit("click")}}},[s("div",{staticClass:"w-4 mr-4"},[e.icon?s("img",{staticClass:"me-4 text-primary-100 text-2xl",attrs:{src:e.icon}}):e._e()]),s("div",[s("div",[e._v(e._s(e.title))]),e.subtitle?s("div",{staticClass:"text-xs",class:e.subtitleClass},[e._v(e._s(e.subtitle))]):e._e()]),s("div",{attrs:{ckass:"flex-grow"}}),e.loading?s("i",{staticClass:"icon-spinner animate-spin"}):e.appendIcon?s("i",{staticClass:"se-4 text-primary-100 text-2xl",class:e.appendIcon}):e._e()])},n=[],a={components:{},props:{title:{type:String,default:""},subtitle:{type:String,default:""},subtitleClass:{type:String,default:""},icon:{type:String,default:""},appendIcon:{type:String,default:""},to:{type:String,default:""},loading:{type:Boolean}}},r=a,l=s(1001),o=(0,l.Z)(r,i,n,!1,null,null,null),c=o.exports},44021:function(e,t,s){s.d(t,{Z:function(){return c}});var i=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"flex items-center justify-center"},[s("input",{staticClass:"toggle-checkbox absolute block w-6 h-6 rounded-full bg-white border-4 appearance-none",class:e.disabled?"cursor-not-allowed":"cursor-pointer",attrs:{type:"checkbox",name:"toggle"},domProps:{checked:e.checked}}),s("label",{staticClass:"relative w-12 h-6 flex select-none",class:e.disabled?"cursor-not-allowed":"cursor-pointer",attrs:{for:"toggle"}},[s("span",{staticClass:"absolute left-0 top-0 h-full w-full rounded-full",class:{"bg-accent":e.checked,"bg-dark-N20":!e.checked}}),s("span",{staticClass:"h-6 w-6 border-2 absolute rounded-full bg-white transition-transform duration-300 ease-in-out flex justify-center items-center",class:{"right-0":e.checked,"border-accent":e.checked,"border-dark-N20":!e.checked}})])])},n=[],a={props:{checked:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1}}},r=a,l=s(1001),o=(0,l.Z)(r,i,n,!1,null,null,null),c=o.exports},40072:function(e,t,s){s.d(t,{Z:function(){return c}});var i=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("transition",{attrs:{name:"fade"}},[e.showing?s("div",{staticClass:"fade fixed bottom-0 left-0 right-0 top-0 z-50 px-4 bg-black opacity-60",on:{click:e.close}}):e._e()]),s("transition",{attrs:{name:"slide"}},[e.showing?s("div",{staticClass:"fixed bottom-0 left-1/2 -translate-x-1/2 z-50 p-4 rounded-t-3xl bg-modal max-h-screen overflow-y-scroll w-screen max-w-screen-sm"},[e._t("default")],2):e._e()])],1)},n=[],a={data(){return{showing:!1}},methods:{close(){this.$emit("close"),this.showing=!1},show(){this.showing=!0}}},r=a,l=s(1001),o=(0,l.Z)(r,i,n,!1,null,"774449d9",null),c=o.exports},3393:function(e,t,s){s.d(t,{Z:function(){return h}});var i=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("bottom-sheet",{ref:"sheet"},[s("div",[e.title?s("div",{staticClass:"font-bold text-xl mb-2"},[e._v(" "+e._s(e.title)+" ")]):e._e(),e._l(e.items,(function(t){return s("div",{key:t.key,on:{click:function(s){return e.itemClicked(t.key)}}},["listItem"===t.type?s("list-item",{staticClass:"-mx-4",attrs:{title:t.title,subtitle:t.subtitle,"subtitle-class":t.subtitleClass,"append-icon":t.appendIcon,loading:t.loading,icon:t.icon},on:{click:function(s){return e.itemClicked(t.key)}}}):e._e(),"divider"===t.type?s("div",{staticClass:"border-t border-positive-10 my-2"}):e._e()],1)}))],2)])},n=[],a=s(40072),r=s(33873),l={components:{BottomSheet:a.Z,ListItem:r.Z},data(){return{title:null,items:null,onItemClicked:null,action:null}},methods:{show(e,t=[],s,i){this.title=e,this.items=t,this.onItemClicked=s,this.action=i,this.$refs.sheet.show()},itemClicked(e){this.onItemClicked&&this.onItemClicked(e),this.$refs.sheet.close()}}},o=l,c=s(1001),d=(0,c.Z)(o,i,n,!1,null,null,null),h=d.exports},86276:function(e,t,s){s.r(t),s.d(t,{default:function(){return k}});var i=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"flex flex-col"},[i("top-bar",{attrs:{title:e.$t("general.fioHandle"),"back-override":e.backOverride}}),i("div",{staticClass:"flex flex-col items-center px-8 py-8 flex-grow"},[i("div",{staticClass:"flex flex-row items-center w-full bg-n3 rounded-lg p-4"},[i("img",{staticClass:"w-10 h-10",attrs:{src:s(81741)}}),i("div",{staticClass:"ms-2 text-emphasis-high text-md font-bold text-center"},[e._v(" "+e._s(e.handle)+" ")]),i("div",{staticClass:"flex-grow"})]),i("div",{staticClass:"flex flex-col w-full mt-4",class:{"pointer-events-none animate-pulse":e.isLoading}},e._l(e.connections,(function(t,s){return i("div",{key:t.symbol,staticClass:"flex justify-between items-center px-4 py-3 mb-2 bg-n2 rounded-lg cursor-pointer",on:{click:function(t){return e.toggle(s)}}},[i("token-icon",{staticClass:"rounded-full object-contain h-10 w-10",attrs:{chain:e.connection2chain(t),address:e.nullAddress}}),i("div",{staticClass:"flex-1 mx-4"},[i("div",[e._v(e._s(t.name))]),i("div",{staticClass:"text-xs text-emphasis-medium"},[e._v(e._s(s))])]),i("opera-checkbox",{class:"t-fio-"+s+"-switch",attrs:{checked:e.checked(s)}})],1)})),0),i("alert-dialog",{ref:"errorDialog"}),i("list-sheet",{ref:"handleSheet"}),i("div",{staticClass:"bottom-group"},[i("div",{staticClass:"flex-col p-4"},[i("div",{staticClass:"text-dark-N77 font-bold m-8 leading-5 text-sm",class:{"opacity-0":!e.changes.dirty}},[e._v(" Your changes need confirmation or they will be discarded if you leave this screen. ")]),i("primary-button",{staticClass:"flex-1 w-full",attrs:{disabled:!e.changes.dirty,loading:e.isLoading,title:e.$t("general.save")},on:{click:e.save}})],1)])],1)],1)},n=[],a=(s(57658),s(54907)),r=s(3393),l=s(44021),o=s(87307),c=s(56258),d=s(53106),h=s(74293),u=s(30668),f=s(81732),g=s(39765),m=s(98360),p=s(77122);function b(e,t){switch(e){case p.Do.INSUFFICIENT_FUNDS:return"errors.generic.insufficientFunds";case p.Do.GAS_INSUFFICIENT_FUNDS:return"errors.insufficientFunds";case p.Do.NERVOS_CKB_NOT_ENOUGH_ERROR:return"errors.nervos.ckb_not_enough";case p.Do.NEAR_AMOUNT_TOO_LOW:return"errors.near.nearAmountTooLow";case p.Do.INVALID_RECIPIENT:return"errors.generic.invalidRecipient";case p.Do.SWAP_SAME_TOKEN:return"errors.swappingTheSameToken";case p.Do.SWAP_INVALID:return"errors.generic.invalidSwap";case p.JS.COULD_NOT_CREATE_WALLET:return"errors.restore.createWallet";case p.JS.COULD_NOT_SAVE_WALLET:return"errors.restore.saveWallet";case p._e.INVALID_MNEMONIC:return"errors.restore.invalidBackupPhrase";case p.JS.MISSING_SECURITY:return"errors.missingSecurity";case p.Do.BTC_AMOUNT_TOO_LOW:return"errors.bitcoin.bitcoinAmountTooLow";default:return t??"errors.somethingWentWrong"}}function v(e,t){switch(e){default:return t??"errors.generic.oops"}}var _=s(25108),x={components:{PrimaryButton:o.Z,TopBar:h.Z,OperaCheckbox:l.Z,AlertDialog:a.Z,ListSheet:r.Z,TokenIcon:d.Z},data(){return{loading:{addresses:!1,connectable:!1,handles:!1,saving:!1},connections:f.T_,nullAddress:g.L1,selected:{},handles:[],handle:"",backOverride:this.$route.params?.backOverride}},computed:{connection2chain(){return e=>(0,m.aP)(e.chainUId)},isLoading(){return Object.values(this.loading).some((e=>!!e))},connectable(){const e=this.$store.getters.getFioConnectableAddresses,t={};if(e?.length)for(const s of e)t[s.chainCode]=s;return t},changes(){const e=this.selected,t=this.original(),s=Object.values(t).filter((t=>!e[t.chainCode])),i=Object.values(e).filter((e=>!t[e.chainCode]));return{dirty:s.length||i.length,removals:s,additions:i}}},watch:{handle:{async handler(e){await this.fetchAllPublicAddressesByHandle(e)},immediate:!0}},async mounted(){c.Z.sendStatsEvent(c.Z.types.IMPRESSION,"wt_setting_fio"),this.handle=this.$route.query.handle,this.loading.handles=!0,await this.$store.dispatch("fetchFioConnectableAddresses"),await this.$store.dispatch("fetchFioHandles"),this.loading.handles=!1},methods:{original(){const e=this.connectable,t=this.$store.getters.getAllPublicAddressesByHandle(this.handle),s={};if(t?.length)for(const i of t)s[i.chain_code]={address:e[i.chain_code]?.address,chainCode:i.chain_code};return s},async fetchAllPublicAddressesByHandle(e){this.loading.addresses=!0,await this.$store.dispatch("fetchAllPublicAddressesByHandle",e),this.selected={...this.original()},this.loading.addresses=!1},untilLoaded(){const e=t=>{const s=this.isLoading;s?setTimeout((()=>e(t)),100):t()};return new Promise((t=>{e(t)}))},showHandleSheet(){if(this.isLoading)return;const e=this.$store.getters.getFioHandles,t=e.map((e=>({title:e,key:e,appendIcon:this.handle===e?"icon-checkmark":null,type:"listItem"})));t.push({type:"divider"}),t.push({title:this.$t("fio.register.createHandle"),key:"action",icon:"icon-plus",type:"listItem"}),this.$refs.handleSheet.show(this.$t("fio.chooseActiveHandle"),t,(t=>{"action"===t?this.$router.push({name:"FioRegister",query:{hasOperaDomain:e.some((e=>e.endsWith("@opera"))).toString()}}):this.handle=t}))},async toggle(e){const t=this.selected[e];t?this.$delete(this.selected,e):this.$set(this.selected,e,{address:this.connectable[e].address,chainCode:e})},checked(e){return!!this.selected[e]},showErrorDialog(e){this.$refs.errorDialog.show(this.$t(v(e.code)),this.$t(b(e.code)),null,(()=>this.$router.replace("/settings")))},async save(){await this.untilLoaded(),this.loading.saving=!0;try{this.changes.additions.length>0&&await u.Z.fioAddAddresses(this.$store.getters.getFioPublicKey,this.handle,this.changes.additions),this.changes.removals.length>0&&await u.Z.fioRemoveAddresses(this.$store.getters.getFioPublicKey,this.handle,this.changes.removals)}catch(e){_.error("ERROR SAVING",e)}await this.fetchAllPublicAddressesByHandle(this.handle),this.loading.saving=!1}}},w=x,C=s(1001),y=(0,C.Z)(w,i,n,!1,null,null,null),k=y.exports},81741:function(e,t,s){e.exports=s.p+"img/fio.9ee8d805.svg"},54398:function(e,t,s){e.exports=s.p+"img/success.5827329e.svg"}}]);