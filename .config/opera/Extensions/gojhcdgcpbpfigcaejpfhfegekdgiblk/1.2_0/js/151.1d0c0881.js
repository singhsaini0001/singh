(self["webpackChunkdesktop_wallet"]=self["webpackChunkdesktop_wallet"]||[]).push([[151],{45510:function(t,e,s){"use strict";s.d(e,{Z:function(){return c}});var i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("label",{staticClass:"wrapper"},[s("input",{attrs:{type:"checkbox"},domProps:{checked:t.isChecked,value:t.value},on:{change:t.updateInput}}),s("span",{staticClass:"checkmark"})])},n=[],r=(s(57658),{name:"OperaCheckbox",model:{prop:"modelValue",event:"change"},props:{value:{type:[Object,String],default:void 0},modelValue:{type:[Array,Boolean],default:!1}},computed:{isChecked(){return this.modelValue instanceof Array?this.modelValue.includes(this.value):this.modelValue===this.value}},methods:{updateInput(t){const e=t.target.checked;if(this.modelValue instanceof Array){const t=[...this.modelValue];e?t.push(this.value):t.splice(t.indexOf(this.value),1),this.$emit("change",t)}else this.$emit("change",e)}}}),a=r,o=s(1001),l=(0,o.Z)(a,i,n,!1,null,"653c3784",null),c=l.exports},11013:function(t,e,s){"use strict";s.d(e,{Z:function(){return d}});var i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return t.disabled?t._e():s("div",{staticClass:"t-token_item-click flex justify-between items-center px-6 py-3 mb-2 bg-dark-N16 border border-black border-opacity-10 rounded-lg cursor-pointer",on:{click:t.click}},[s("token-icon",{staticClass:"w-8 h-8",attrs:{chain:t.chain,address:t.address,"icon-uri":t.value.logoURI}}),s("div",{staticClass:"flex-1 mx-4"},[s("div",{staticClass:"font-bold tracking-wider"},[t._v(t._s(t.name))]),s("div",{staticClass:"flex items-center text-xs text-dark-N77"},[s("span",{staticClass:"mr-2"},[t._v(t._s(t.symbol))]),s("chain-badge",{attrs:{"background-color":"bg-input-bg",chain:t.chain}}),t.type&&t.type!==t.symbol?s("div",{staticClass:"inline-block bg-input-bg rounded-full px-2 py-0 ml-1"},[t._v(" "+t._s(t.type)+" ")]):t._e()],1)]),t.selectable?s("opera-checkbox",{ref:"checkbox",staticClass:"pointer-events-none",attrs:{"model-value":t.modelValue,value:t.value},on:{change:t.onChange}}):t._e()],1)},n=[],r=s(61627),a=s(45510),o=s(53106),l=s(56258),c={components:{ChainBadge:r.Z,OperaCheckbox:a.Z,TokenIcon:o.Z},model:{prop:"modelValue",event:"change"},props:{chain:{type:Object,default:void 0},address:{type:String,default:""},name:{type:String,default:""},symbol:{type:String,default:""},value:{type:[String,Object,Array],default:void 0},modelValue:{type:[String,Object,Array],default:void 0},selectable:{type:Boolean,default:!0},disabled:{type:Boolean,default:!1}},computed:{type(){const t=this.value.type??this.value.contract?.type;if(t)return!1}},methods:{click(){this.selectable?this.$refs.checkbox.$el.click():this.$emit("change",this.value)},onChange(t){const[e,s]=[this.$store.getters.getNetworkName(this.chain),this.symbol],i=this.getStatsEventName();l.Z.sendStatsEvent(l.Z.types.CLICK,i,{symbol:s,network:e}),this.$emit("change",t)},getStatsEventName(){if("WatchListSelect"===this.$route.name){const t=this.$refs.checkbox.isChecked?"selected":"unselected";return`wt_watch_coin_${t}`}return"ReceiveToken"===this.$route.name?"wt_receive_select":"wt_coin_selected"}}},h=c,u=s(1001),p=(0,u.Z)(h,i,n,!1,null,null,null),d=p.exports},61627:function(t,e,s){"use strict";s.d(e,{Z:function(){return h}});var i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return t.chainNameFriendly?s("div",{staticClass:"t-chain-badge flex space-x-1 text-dark-N77 rounded-full px-2 py-0.5 mr-2",class:[t.backgroundColor]},[t.chainLogo?s("img",{staticClass:"w-3.5 object-contain",attrs:{src:t.chainLogo,alt:""}}):t._e(),s("span",{staticClass:"t-chain-badge-name"},[t._v(t._s(t.chainNameFriendly))])]):t._e()},n=[],r=s(18454),a={name:"ChainBadge",props:{backgroundColor:{type:String,default:"bg-dark-N16"},chain:{type:Object,default:void 0}},computed:{chainLogo(){if(this.chain)return(0,r.Z)(this.chain).icon()},chainNameFriendly(){if(this.chain)return this.$store.getters.chainNameFriendly(this.chain)}}},o=a,l=s(1001),c=(0,l.Z)(o,i,n,!1,null,null,null),h=c.exports},18238:function(t,e,s){"use strict";s.d(e,{Z:function(){return p}});var i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"flex flex-row space-x-4 rtl-space-x-reverse overflow-x-auto"},t._l(t.percentageValues,(function(e){var i=e.label,n=e.divisor;return s("button",{key:i,staticClass:"text-sm font-bold px-2 py-1 border rounded-md text-brand-primary w-14",class:[{"border-brand-primary bg-brand-primary bg-opacity-5":i===t.selected,"border-black border-opacity-20 bg-gray":i!==t.selected},"t-perc-btn t-perc-btn-"+i],on:{click:function(e){return t.select({label:i,divisor:n})}}},[s("span",1===n?[t._v(t._s(t.$t("general.max")))]:[t._v(t._s(t.localizePercentage(i)))])])})),0)},n=[],r=s(70794),a=s(4634),o=s(98180),l={name:"PercentageButtons",props:{token:{type:Object,default:void 0},value:{type:[r.Z,Number,String],default:void 0}},data(){return{percentageValues:[{label:"25",divisor:4},{label:"50",divisor:2},{label:"100",divisor:1}],selected:null,calculatedAmount:null}},watch:{value(){this.value!==this.calculatedAmount&&(this.selected=null)}},methods:{localizePercentage:a.ZP.localizePercentage,select({label:t,divisor:e}){this.selected=t,this.calculateAmount(e)},calculateAmount(t){const e=Object.assign({},this.token,{balance:new r.Z(this.token.balance).dividedBy(t)});this.calculatedAmount=o.Z.tokenDecimal(e)||(0,r.Z)(0),this.$emit("change",this.calculatedAmount)}}},c=l,h=s(1001),u=(0,h.Z)(c,i,n,!1,null,null,null),p=u.exports},85151:function(t,e,s){"use strict";s.r(e),s.d(e,{default:function(){return U}});var i=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"flex flex-col flex-grow h-full"},[i("top-bar",{attrs:{title:t.$t("general.swap"),"test-parent-name":"swap_view"}}),i("div",{staticClass:"flex flex-col flex-grow mt-4 mx-4 justify-center"},[i("swap-input",{staticClass:"t-swap-from_balance",attrs:{type:"from",balance:t.fromBalance},model:{value:t.from,callback:function(e){t.from=e},expression:"from"}}),i("div",{staticClass:"flex flex-col items-center"},[i("horizontal-divider",[i("button",{staticClass:"t-swap-switch bg-brand-primary w-10 h-10 rounded-full flex-shrink-0 bg-opacity-10",class:{"cursor-not-allowed":t.disableTokenSwitch},attrs:{disabled:t.disableTokenSwitch,title:t.disableTokenSwitch?t.$t("general.youDontOwnAny",{asset:t.toSymbol}):""},on:{click:t.switchTokens}},[i("i",{staticClass:"icon icon-exchange text-brand-primary align-bottom"})])])],1),i("swap-input",{staticClass:"t-swap-to_balance",attrs:{balance:t.toBalance,"read-only":!0,type:"to"},model:{value:t.to,callback:function(e){t.to=e},expression:"to"}}),i("div",{staticClass:"mt-20"},[t.error?i("div",{staticClass:"text-spectrum-red text-sm text-center flex justify-center"},[i("img",{staticClass:"mx-2",attrs:{src:s(98498),alt:""}}),i("span",[t._v(t._s(t.error))])]):i("div",{staticClass:"text-neutral-07 text-md text-center"},[t._v(" "+t._s(t.conversion)+" ")])])],1),i("div",{staticClass:"flex flex-col items-center mx-13 leading-3 text-2xs text-center"},[i("p",[t._v(t._s(t.$t("general.poweredBy",{serviceProvider:""})))]),i("img",{staticClass:"h-6 my-1",attrs:{src:s(61986)("./"+t.swapProvider+".svg"),alt:""}}),i("i18n",{attrs:{path:"legal.swapProvider",tag:"p"},scopedSlots:t._u([{key:"swapProvider",fn:function(){return[i("span",[t._v(t._s(t.swapProvider))])]},proxy:!0},{key:"swapProviderTerms",fn:function(){return[i("a",{staticClass:"t-swap_view-tos text-brand-primary",attrs:{target:"_blank",rel:"noopener noreferrer",href:t.swapProviderTermsLink}},[t._v(" "+t._s(t.$t("legal.swapProviderTerms"))+" ")])]},proxy:!0}])})],1),i("primary-button",{staticClass:"t-swap-swap mt-4 mb-6 mx-4",attrs:{title:t.$t("general.swap"),loading:t.isLoading||!!t.currentPendingApprovalHash,disabled:!(!t.isSwapUnavailable||!t.isApproveUnavailable||t.currentPendingApprovalHash),"allow-click-while-loading":!!t.currentPendingApprovalHash},on:{click:function(e){t.currentPendingApprovalHash||t.isApproveRequired?t.getApprove():t.getSwap()}}})],1)},n=[],r=(s(57658),s(70794)),a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"line-divider my-10 w-full border-opacity-10"},[t._t("default")],2)},o=[],l={name:"HorizontalDivider"},c=l,h=s(1001),u=(0,h.Z)(c,a,o,!1,null,"7ff2716d",null),p=u.exports,d=s(87307),f=s(56258),m=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"w-full"},[s("div",{staticClass:"flex flex-col items-center"},[s("div",{staticClass:"flex flex-row justify-center"}),s("div",{staticClass:"text-center flex flex-col justify-center w-full"},[s("label",{staticClass:"mb-1 text-sm",attrs:{for:"input"}},[t._v(t._s(t.$t("general."+t.type)))]),s("input",{staticClass:"input focus:text-brand-primary bg-neutral-02 py-2",class:[{"input-error":t.error},{"cursor-not-allowed px-8":t.readOnly},{"px-10":!t.readOnly}],attrs:{type:t.readOnly?"text":"number",placeholder:"0,0",title:"",disabled:t.readOnly},domProps:{value:t.value.value},on:{paste:function(e){return t.handleValueChanged(e)},input:function(e){return t.handleValueInput(e)}}})]),t.error?s("div",{staticClass:"text-spectrum-red text-sm text-center mt-2"},[t._v(" "+t._s(t.error)+" ")]):t._e(),s("div",{staticClass:"text-sm text-dark-N77 text-center my-3"},[t._v(" "+t._s(t.$t("general.balance"))+": "+t._s(t.fullBalance)+" ")]),s("div",{staticClass:"t-swap_input-show_dialog flex justify-center items-center cursor-pointer",on:{click:t.showDialog}},[s("token-icon",{staticClass:"w-6 h-6",attrs:{chain:t.chain,address:t.address}}),s("span",{staticClass:"px-2 font-bold"},[t._v(t._s(t.name))]),s("i",{staticClass:"icon-chevron_down"})],1),t.readOnly?t._e():s("percentage-buttons",{staticClass:"mt-5",attrs:{token:Object.assign({},t.token,{balance:t.balanceWithoutDecimals}),value:t.value.value},on:{change:t.assignNewAmount}})],1),s("swap-token-dialog",{ref:"dialog",attrs:{type:t.type}})],1)},v=[],g=s(18238),k=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{directives:[{name:"show",rawName:"v-show",value:t.showing,expression:"showing"}],staticClass:"bg-background fixed top-0 bottom-0 left-0 right-0 z-10"},[s("div",{staticClass:"flex flex-col h-full"},[s("top-bar",{attrs:{title:t.$t("general.selectAssets"),"emit-back":!0,"test-parent-name":"swap_token_dialog"},on:{back:function(e){return t.close()}}}),s("div",{staticClass:"px-4"},[s("opera-input",{staticClass:"t-swap_token_dialog-query",attrs:{round:!0,"prepend-icon":"icon-search text-brand-primary text-opacity-40",placeholder:t.$t("general.search")},model:{value:t.query,callback:function(e){t.query=e},expression:"query"}})],1),s("div",{staticClass:"px-4 pb-4 overflow-y-scroll h-full",on:{scroll:t.onScroll}},[t.loading&&t.query?s("div",{staticClass:"w-full flex-1 flex justify-center items-center"},[s("i",{staticClass:"icon-spinner animate-spin text-xl"})]):t._l(t.filteredTokens,(function(e,i){return s("token-item",{key:i,attrs:{chain:e.chain,address:e.address,name:e.name,symbol:e.symbol,value:e,selectable:!1,disabled:t.isTokenDisabled(e)},on:{change:t.itemClicked}})}))],2)],1)])},w=[],b=s(35210),y=s(11013),x=s(74293),T=s(932),_=s(39765),C=s(98180);const $=20;var A={components:{TopBar:x.Z,TokenItem:y.Z,OperaInput:T.Z},props:{type:{type:String,default:""}},data(){return{showing:!1,loading:!1,n:$,callback:null,query:"",filteredAssets:[]}},computed:{tokens(){const t=this.$store.getters.swappableTokens;if("to"===this.type){const e=this.currentSwap.fromToken?.chain??{};return t.filter((t=>(0,b.F2)(t.chain,e)))}return t.filter((t=>this.isTokenOwned(t)))},filteredTokens(){return this.query?this.filteredAssets.slice(0,this.n):this.tokens.slice(0,this.n)},currentSwap(){return this.$store.getters.currentSwap},ownedTokens(){return this.$store.getters.ownedTokens}},watch:{query:{immediate:!0,handler:function(t){this.loading=!0,this.filteredAssets=[],t?this.$nextTick((()=>{this.throttle(this.filterList,1e3)(),this.n=$})):this.$nextTick((()=>{this.n=$}))}}},methods:{show(t){this.callback=t,this.showing=!0},async itemClicked(t){this.loading=!0,this.callback(t),this.showing=!1,this.loading=!1},close(){this.showing=!1},onScroll(t){const e=t.target,s=e.scrollTop+e.clientHeight>=e.scrollHeight-e.clientHeight;s&&(this.n+$<this.tokens.length?this.n+=$:this.n=this.tokens.length-1)},throttle(t,e){let s,i;return function(...n){const r=Date.now(),a=this;if(i||(i=r),clearTimeout(s),r-i>e)return i=r,t.apply(a,n),void clearTimeout(s);s=setTimeout((function(){i=Date.now(),s=null,t.apply(a,n)}),e)}},filterList(){const t=this.query.toLowerCase();this.filteredAssets=this.tokens.filter((e=>e.name.toLowerCase().includes(t)||e.symbol.toLowerCase().includes(t))),this.loading=!1},isTokenDisabled(t){if(!Object.keys(this.currentSwap).length)return;const e="from"===this.type?"to":"from",s=C.Z.isSameToken(this.currentSwap[`${e}Token`],t);return s||"from"===this.type&&!this.isTokenOwned(t)},isTokenOwned(t){return!!this.ownedTokens.find((e=>{let s=t.address;return s===_.NA&&(s=_.L1),C.Z.isSameToken(e,t)}))}}},S=A,Z=(0,h.Z)(S,k,w,!1,null,null,null),P=Z.exports,E=s(53106),N=s(4634),O={components:{SwapTokenDialog:P,TokenIcon:E.Z,PercentageButtons:g.Z},props:{value:{type:Object,default:void 0},readOnly:{type:Boolean},type:{type:String,default:""},balance:{type:r.Z,default:""}},data(){return{focused:!1,token:{},inputEventTimeout:null}},computed:{chain(){return this.token.chain},error(){const t="from"===this.type&&this.$store.getters.txError.insufficientFunds;return t&&this.$t("errors.generic.insufficientFunds")},name(){return this.token.name},symbol(){return this.token.symbol},address(){return this.token.address},maxValue(){return this.readOnly?Number.MAX_SAFE_INTEGER:this.balance},fullBalance(){return this.$store.getters.getFullTokenBalance(this.address,this.token,this.chain)},balanceWithoutDecimals(){const t=this.balance??0;return C.Z.withoutDecimals(t,this.token.decimals)}},watch:{value(t){this.token=t.token}},created(){this.token=this.value.token},methods:{formatNumber:N.ZP.formatNumber,handleValueChanged(t){const e=this.sanitizeValue(t);this.$emit("input",{token:this.token,value:e})},handleValueInput(t){this.inputEventTimeout&&clearTimeout(this.inputEventTimeout),this.inputEventTimeout=setTimeout((()=>{this.handleValueChanged(t),clearTimeout(this.inputEventTimeout)}),1e3)},showDialog(){this.$refs.dialog.show((t=>{this.token=t,this.$emit("input",{token:this.token,value:null})}))},sanitizeValue(t){let e=t.target?.value;if(!e||isNaN(+e[0]))return null;e=e.replace(",",".");const s=e.startsWith("00");return s?null:e},assignNewAmount(t){this.$emit("input",{token:this.token,value:t})}}},q=O,I=(0,h.Z)(q,m,v,!1,null,"7f0568da",null),L=I.exports,B=s(82482),D=s(87137);class j{constructor(t,e){(0,B.Z)(this,"accountAddress",void 0),(0,B.Z)(this,"_api",void 0),(0,B.Z)(this,"contract",void 0),(0,B.Z)(this,"providerLink",void 0),(0,B.Z)(this,"providerName",void 0),this.accountAddress=t,this._api=(0,D.Z)(t,e),this.contract=this._api?.contract,this.providerLink=this._api.providerLink,this.providerName=this._api.providerName}getQuote(t,e){return this._api.getQuote(t,e)}swap(t,e){return this._api.getSwap(t,e)}async checkApprove(t,e,s){if(this._api.allowanceToLow&&!await this._api.allowanceToLow(t,e,s))return Promise.reject(s);const i="0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff";return await this._api.approve(t,i)}}var V=s(25108),Q={components:{TopBar:x.Z,PrimaryButton:d.Z,SwapInput:L,HorizontalDivider:p},data(){return{approve:null,chain:null,error:null,from:{token:null,value:null},interval:null,isApprovalsPending:!1,loading:{approve:!1,quote:!1,swap:!1},quote:null,swapper:null,to:{token:null,value:null}}},computed:{accountAddress(){return this.$store.getters.ethereumAddress},amountWithoutDecimals(){if(!this.from.token||!this.from.value)return null;const t=N.ZP.removeExponential(C.Z.withoutDecimals(this.from.value,this.from.token.decimals));return t},conversion(){const t=this.quote;if(!t)return null;const e=C.Z.withDecimals(t.fromTokenAmount,t.fromToken.decimals),s=t.fromToken.symbol,i=C.Z.withDecimals(t.toTokenAmount,t.toToken.decimals).dividedBy(e),n=t.toToken.symbol;return`1 ${s} ≈ ${N.ZP.formatNumber(i)} ${n}`},currentPendingApprovalHash(){return this.$store.getters.currentPendingApprovalHash},currentSwap(){return this.$store.getters.currentSwap},disableTokenSwitch(){const t=!!this.ownedTokens.find((t=>{let e=t.contract.contract;return e===_.L1&&(e=_.NA),e===this.to.token?.address}));return!t&&(!t||!this.from.value||this.isLoading)},fromBalance(){return this.tokenBeingSwapped?C.Z.tokenDecimal(this.tokenBeingSwapped):null},fromSymbol(){return this.from&&this.from.token?this.from.token.symbol:""},generalTxError(){return!!this.error||Object.values(this.$store.getters.txError).some((t=>t))},invalidBalance(){return!this.from.token||(this.fromBalance.isLessThan((0,r.Z)(this.from.value))||this.fromBalance.isLessThanOrEqualTo((0,r.Z)(0))||(0,r.Z)(this.from.value).isLessThanOrEqualTo((0,r.Z)(0)))},isApproveRequired(){return!!this.approve},isApproveUnavailable(){return this.isInInvalidState||this.isApprovalsPending||!this.isApproveRequired},isInInvalidState(){return this.generalTxError||!!this.error||this.isLoading||this.invalidBalance||!this.quote||!this.$store.getters.isOnMainnet},isLoading(){return Object.values(this.loading).some((t=>t))},isSwapUnavailable(){return this.isInInvalidState||this.isApprovalsPending||this.isApproveRequired},ownedTokens(){return this.$store.getters.ownedTokens},pendingApprovals(){return this.$store.getters.pendingApprovals},swappableTokens(){return this.$store.getters.swappableTokens},swapProvider(){if(this.swapper)return this.swapper.providerName},swapProviderLink(){if(this.swapper)return this.swapper.providerLink},swapProviderTermsLink(){if(this.swapper)return this.$store.state.swap.swapProviderTerms[this.swapProvider]},toBalance(){const t=this.determineTokenAddress(this.to.token),e=this.to.token.chain,s=this.$store.getters.getToken(t,e);return s?C.Z.tokenDecimal(s):null},toSymbol(){return this.to&&this.to.token?this.to.token.symbol:""},tokenBeingSwapped(){if(!this.from.token)return null;const t=this.determineTokenAddress(this.from.token),e=this.from.token.chain;return this.$store.getters.getToken(t,e)}},watch:{from:{deep:!0,handler(){this.$store.dispatch("clearTxError"),this.swapper=new j(this.accountAddress,this.from.token.chain),(0,r.Z)(this.from.value).isGreaterThan(this.fromBalance)&&this.$store.dispatch("setTxError","insufficientFunds"),this.error=null,this.approve=null,this.updateQuote(),this.updateQueryParams(),this.to.token?.chain.chainId!==this.chain.chainId&&this.setInitialToken("to"),this.$store.commit("SET_CURRENT_SWAP",{fromToken:this.from.token,toToken:this.to.token})}},pendingApprovals:{deep:!0,handler(t){const e=Object.keys(t).length>0;this.isApprovalsPending=e}},"to.token":{deep:!0,handler(){this.error=null,this.updateQuote(),this.updateQueryParams(),this.$store.commit("SET_CURRENT_SWAP",{fromToken:this.from.token,toToken:this.to.token})}},quote(t){this.$set(this.to,"value",t?C.Z.withDecimals(t.toTokenAmount,t.toToken.decimals):null)}},created(){f.Z.sendStatsEvent(f.Z.types.IMPRESSION,"wt_swap_entered"),this.chain=JSON.parse(this.$route.query.chain),this.swapper=new j(this.accountAddress,this.chain);const t=this.$route.query.from,e=this.$route.query.to,s=this.$route.query.value||null;this.setInitialToken("from",t,s),this.setInitialToken("to",e),this.currentPendingApprovalHash&&this.updateQuote()},beforeDestroy(){this.$store.dispatch("clearTxError"),clearInterval(this.interval)},methods:{updateQueryParams(){const t={};this.from.token&&(this.chain=this.from.token.chain,t.from=this.from.token.address,t.chain=JSON.stringify(this.from.token.chain)),this.from.value&&(t.value=this.from.value),this.to.token&&(t.to=this.to.token.address),this.$router.replace({path:this.$route.path,query:t}).catch((()=>{}))},switchTokens(){const t=this.to;this.to=this.from,this.from=t},updateQuote(){if(0===this.from.value||this.generalTxError)return;const t=this.to.token?this.to.token.address:null,e=this.from.token?this.from.token.address:null,s=this.amountWithoutDecimals;if(!(t&&e&&s))return this.quote=null,this.loading.quote=!1,void(this.error=null);this.loading.quote?this.pendingApprovals.length&&this.pendingApprovals.find((t=>t.token.address!==e))&&(clearInterval(this.interval),this.getQuote()):(clearInterval(this.interval),this.currentPendingApprovalHash?this.interval=setInterval((()=>{this.getQuote()}),5e3):this.getQuote())},async getQuote(){this.loading.quote=!0;try{const t=await this.swapper.getQuote(this.from,this.to);this.quote=this.repopulateQuote(t),this.$store.commit("SET_CURRENT_SWAP",this.quote),this.error=null,await this.checkApprove()}catch(t){V.error(t),this.quote=null,this.error=this.generateSwapErrorText(t)}this.loading.quote=!1},getApprove(){if(this.currentPendingApprovalHash){const t=this.$store.getters.transactionDetailsUrl(this.currentPendingApprovalHash,this.chain);this.$platform.openNewTab(t)}else this.isApproveUnavailable||this.$router.push({name:"ApproveConfirm",params:{approve:this.approve,contract:this.swapper.contract,swapProvider:this.swapProvider,swapProviderLink:this.swapProviderLink,token:this.from}})},async getSwap(){if(!this.isSwapUnavailable){this.loading.swap=!0;try{const t=await this.swapper.swap(this.from,this.to);this.next(this.repopulateQuote(t))}catch(t){V.error(t),this.checkApprove(t),this.error=this.generateSwapErrorText(t)}finally{this.loading.swap=!1}}},async next(t){f.Z.sendStatsEvent(f.Z.types.CLICK,"wt_swap_next_suc",{network:this.$store.getters.getNetworkName(this.chain)}),this.$store.commit("SET_CURRENT_SWAP",t);const e=this.chain;this.$router.push({name:"SwapConfirm",params:{swap:t,chain:e}})},async checkApprove(t){if(this.quote&&!this.error){this.loading.approve=!0;try{t?this.swapper.checkApprove(this.from,this.to,t).then((t=>{this.approve=t})):await this.swapper.swap(this.from,this.to).then((()=>{setTimeout((()=>{Object.keys(this.pendingApprovals).length&&this.$store.dispatch("clearPendingApproval",{symbol:this.from.token.symbol,chain:this.chain})}),5e3),clearInterval(this.interval),this.approve=null})).catch((async t=>await this.swapper.checkApprove(this.from,this.to,t).then((t=>{this.approve=t}))))}catch(t){V.error(t),this.error=this.generateSwapErrorText(t),clearInterval(this.interval)}finally{this.loading.approve=!1}}},generateSwapErrorText(t){const e=(t.response?.data?.description??"").toLowerCase();return this.fromSymbol===this.toSymbol?this.$t("errors.swappingTheSameToken"):e.includes("insufficient funds")||e.includes("not enough")?this.$t("errors.generic.insufficientFunds"):e.includes("insufficient liquidity")?this.$t("errors.insufficientLiquidity"):e.includes("cannot estimate")?this.$t("errors.insufficientFunds"):this.$t("errors.generic.unknownError")},determineTokenAddress(t){if(t)return t.address===_.NA?_.L1:t.address},setInitialToken(t,e=null,s=null){const i=this.swappableTokens.filter((t=>t.chain.chainId===this.chain.chainId));let n=i.find((t=>t.address===e));if(e&&n)this[t]={value:s,token:n};else{const e="from"===t?"to":"from";n=i.find((t=>t.address!==this[e].token.address)),this[t]={value:s,token:n}}},repopulateQuote(t){return Object.assign({},t,{fromToken:this.from.token,toToken:this.to.token})}}},R=Q,H=(0,h.Z)(R,i,n,!1,null,null,null),U=H.exports},61986:function(t,e,s){var i={"./1inch.svg":35815,"./PancakeSwap.svg":11496,"./binancecnt.svg":80818,"./ens.svg":35332,"./fio.svg":27200,"./moonpay.svg":82820,"./ramp.svg":82702,"./ud.svg":68237,"./wyre.svg":97061,"./yat.svg":15418};function n(t){var e=r(t);return s(e)}function r(t){if(!s.o(i,t)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return i[t]}n.keys=function(){return Object.keys(i)},n.resolve=r,t.exports=n,n.id=61986},35815:function(t,e,s){"use strict";t.exports=s.p+"img/1inch.34f8ba63.svg"},11496:function(t,e,s){"use strict";t.exports=s.p+"img/PancakeSwap.94943d6f.svg"},80818:function(t,e,s){"use strict";t.exports=s.p+"img/binancecnt.f04ec441.svg"},35332:function(t,e,s){"use strict";t.exports=s.p+"img/ens.b2f0fdfa.svg"},27200:function(t,e,s){"use strict";t.exports=s.p+"img/fio.83de3eb2.svg"},82820:function(t,e,s){"use strict";t.exports=s.p+"img/moonpay.6b4c9c2a.svg"},82702:function(t,e,s){"use strict";t.exports=s.p+"img/ramp.26a0a8eb.svg"},68237:function(t,e,s){"use strict";t.exports=s.p+"img/ud.8f615537.svg"},97061:function(t,e,s){"use strict";t.exports=s.p+"img/wyre.72783911.svg"},15418:function(t,e,s){"use strict";t.exports=s.p+"img/yat.b2137dfd.svg"}}]);