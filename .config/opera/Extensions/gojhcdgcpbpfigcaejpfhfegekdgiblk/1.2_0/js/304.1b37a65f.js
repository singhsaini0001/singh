(self["webpackChunkdesktop_wallet"]=self["webpackChunkdesktop_wallet"]||[]).push([[304],{45510:function(t,e,s){"use strict";s.d(e,{Z:function(){return c}});var i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("label",{staticClass:"wrapper"},[s("input",{attrs:{type:"checkbox"},domProps:{checked:t.isChecked,value:t.value},on:{change:t.updateInput}}),s("span",{staticClass:"checkmark"})])},a=[],n=(s(57658),{name:"OperaCheckbox",model:{prop:"modelValue",event:"change"},props:{value:{type:[Object,String],default:void 0},modelValue:{type:[Array,Boolean],default:!1}},computed:{isChecked(){return this.modelValue instanceof Array?this.modelValue.includes(this.value):this.modelValue===this.value}},methods:{updateInput(t){const e=t.target.checked;if(this.modelValue instanceof Array){const t=[...this.modelValue];e?t.push(this.value):t.splice(t.indexOf(this.value),1),this.$emit("change",t)}else this.$emit("change",e)}}}),r=n,o=s(1001),l=(0,o.Z)(r,i,a,!1,null,"653c3784",null),c=l.exports},11013:function(t,e,s){"use strict";s.d(e,{Z:function(){return p}});var i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return t.disabled?t._e():s("div",{staticClass:"t-token_item-click flex justify-between items-center px-6 py-3 mb-2 bg-dark-N16 border border-black border-opacity-10 rounded-lg cursor-pointer",on:{click:t.click}},[s("token-icon",{staticClass:"w-8 h-8",attrs:{chain:t.chain,address:t.address,"icon-uri":t.value.logoURI}}),s("div",{staticClass:"flex-1 mx-4"},[s("div",{staticClass:"font-bold tracking-wider"},[t._v(t._s(t.name))]),s("div",{staticClass:"flex items-center text-xs text-dark-N77"},[s("span",{staticClass:"mr-2"},[t._v(t._s(t.symbol))]),s("chain-badge",{attrs:{"background-color":"bg-input-bg",chain:t.chain}}),t.type&&t.type!==t.symbol?s("div",{staticClass:"inline-block bg-input-bg rounded-full px-2 py-0 ml-1"},[t._v(" "+t._s(t.type)+" ")]):t._e()],1)]),t.selectable?s("opera-checkbox",{ref:"checkbox",staticClass:"pointer-events-none",attrs:{"model-value":t.modelValue,value:t.value},on:{change:t.onChange}}):t._e()],1)},a=[],n=s(61627),r=s(45510),o=s(53106),l=s(56258),c={components:{ChainBadge:n.Z,OperaCheckbox:r.Z,TokenIcon:o.Z},model:{prop:"modelValue",event:"change"},props:{chain:{type:Object,default:void 0},address:{type:String,default:""},name:{type:String,default:""},symbol:{type:String,default:""},value:{type:[String,Object,Array],default:void 0},modelValue:{type:[String,Object,Array],default:void 0},selectable:{type:Boolean,default:!0},disabled:{type:Boolean,default:!1}},computed:{type(){const t=this.value.type??this.value.contract?.type;if(t)return!1}},methods:{click(){this.selectable?this.$refs.checkbox.$el.click():this.$emit("change",this.value)},onChange(t){const[e,s]=[this.$store.getters.getNetworkName(this.chain),this.symbol],i=this.getStatsEventName();l.Z.sendStatsEvent(l.Z.types.CLICK,i,{symbol:s,network:e}),this.$emit("change",t)},getStatsEventName(){if("WatchListSelect"===this.$route.name){const t=this.$refs.checkbox.isChecked?"selected":"unselected";return`wt_watch_coin_${t}`}return"ReceiveToken"===this.$route.name?"wt_receive_select":"wt_coin_selected"}}},d=c,u=s(1001),h=(0,u.Z)(d,i,a,!1,null,null,null),p=h.exports},61627:function(t,e,s){"use strict";s.d(e,{Z:function(){return d}});var i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return t.chainNameFriendly?s("div",{staticClass:"t-chain-badge flex space-x-1 text-dark-N77 rounded-full px-2 py-0.5 mr-2",class:[t.backgroundColor]},[t.chainLogo?s("img",{staticClass:"w-3.5 object-contain",attrs:{src:t.chainLogo,alt:""}}):t._e(),s("span",{staticClass:"t-chain-badge-name"},[t._v(t._s(t.chainNameFriendly))])]):t._e()},a=[],n=s(18454),r={name:"ChainBadge",props:{backgroundColor:{type:String,default:"bg-dark-N16"},chain:{type:Object,default:void 0}},computed:{chainLogo(){if(this.chain)return(0,n.Z)(this.chain).icon()},chainNameFriendly(){if(this.chain)return this.$store.getters.chainNameFriendly(this.chain)}}},o=r,l=s(1001),c=(0,l.Z)(o,i,a,!1,null,null,null),d=c.exports},18238:function(t,e,s){"use strict";s.d(e,{Z:function(){return h}});var i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"flex flex-row space-x-4 rtl-space-x-reverse overflow-x-auto"},t._l(t.percentageValues,(function(e){var i=e.label,a=e.divisor;return s("button",{key:i,staticClass:"text-sm font-bold px-2 py-1 border rounded-md text-brand-primary w-14",class:[{"border-brand-primary bg-brand-primary bg-opacity-5":i===t.selected,"border-black border-opacity-20 bg-gray":i!==t.selected},"t-perc-btn t-perc-btn-"+i],on:{click:function(e){return t.select({label:i,divisor:a})}}},[s("span",1===a?[t._v(t._s(t.$t("general.max")))]:[t._v(t._s(t.localizePercentage(i)))])])})),0)},a=[],n=s(70794),r=s(4634),o=s(98180),l={name:"PercentageButtons",props:{token:{type:Object,default:void 0},value:{type:[n.Z,Number,String],default:void 0}},data(){return{percentageValues:[{label:"25",divisor:4},{label:"50",divisor:2},{label:"100",divisor:1}],selected:null,calculatedAmount:null}},watch:{value(){this.value!==this.calculatedAmount&&(this.selected=null)}},methods:{localizePercentage:r.ZP.localizePercentage,select({label:t,divisor:e}){this.selected=t,this.calculateAmount(e)},calculateAmount(t){const e=Object.assign({},this.token,{balance:new n.Z(this.token.balance).dividedBy(t)});this.calculatedAmount=o.Z.tokenDecimal(e)||(0,n.Z)(0),this.$emit("change",this.calculatedAmount)}}},c=l,d=s(1001),u=(0,d.Z)(c,i,a,!1,null,null,null),h=u.exports},94495:function(t,e,s){"use strict";s.d(e,{Z:function(){return _}});var i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"w-full"},[t.value?s("div",{staticClass:"t-asset_selector-show_dialog flex bg-input-bg rounded-full cursor-pointer",on:{click:t.showDialog}},[s("token-icon",{staticClass:"w-10 h-8 my-5 mx-4",attrs:{chain:t.chain,address:t.address}}),s("div",{staticClass:"flex items-center justify-between w-full"},[s("div",{staticClass:"tracking-wider truncate"},[s("div",{staticClass:"font-bold text-lg"},[t._v(t._s(t.name))]),s("div",{staticClass:"flex items-center font-bold text-sm text-grey-A flex"},[s("span",{staticClass:"mr-2"},[t._v(t._s(t.symbol))]),s("chain-badge",{attrs:{chain:t.chain}})],1)]),s("i",{staticClass:"w-6 m-4 icon-chevron_down text-dark-N60"})])],1):t._e(),s("asset-selector-dialog",{ref:"dialog",attrs:{options:t.options,value:t.value,"still-loading-count":t.stillLoadingCount}})],1)},a=[],n=s(20144),r=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{directives:[{name:"show",rawName:"v-show",value:t.showing,expression:"showing"}],staticClass:"bg-background fixed top-0 bottom-0 left-0 right-0 z-10"},[s("div",{staticClass:"flex flex-col h-full"},[s("top-bar",{attrs:{title:t.$t("general.selectAssets"),"emit-back":!0,"test-parent-name":"asset_selector_dialog"},on:{back:function(e){return t.close()}}}),s("div",{staticClass:"px-4"},[s("opera-input",{staticClass:"t-token_dialog-query",attrs:{value:t.search,"prepend-icon":"icon-search text-brand-primary text-opacity-40",type:"search",placeholder:t.$t("general.search")},on:{input:t.updateSearch}})],1),s("div",{staticClass:"px-4 pb-4 overflow-y-scroll h-full",on:{scroll:t.onScroll}},[t._l(t.tokenList,(function(e,i){return s("div",{key:i},[s("token-item",{staticClass:"my-3",attrs:{chain:e.chain,address:"contract"in e?e.contract.contract:e.address,name:"contract"in e?e.contract.name:e.name,symbol:"contract"in e?e.contract.symbol:e.symbol,value:e,selectable:!1},on:{change:t.itemClicked}})],1)})),t._l(t.stillLoadingCount,(function(t){return s("div",{key:"loading-"+t,staticClass:"t-token_loading_item flex justify-between items-center px-6 py-3 mb-2 bg-dark-N16 border border-black border-opacity-10 rounded-lg mt-3 cursor-wait",style:{opacity:1/t}},[s("div",{staticClass:"h-10"},[s("lottie-component",{staticClass:"h-10",attrs:{src:"loader_tx.json"}})],1)])}))],2)],1)])},o=[],l=s(71671),c=s(932),d=s(11013),u=s(74293);const h=20;var p=n.Z.extend({name:"AssetSelectorDialog",components:{LottieComponent:l.Z,OperaInput:c.Z,TokenItem:d.Z,TopBar:u.Z},props:{options:{type:Array,default:void 0},stillLoadingCount:{type:Number,default:0},value:{type:Object,default:void 0}},data(){return{callback:null,loading:!1,pageSize:h,search:"",showing:!1}},computed:{tokens(){return this.options},tokenList(){const t=this.tokens;return this.search?t.filter((t=>("contract"in t?t.contract.name:t.name).toLowerCase().includes(this.search.toLowerCase()))).slice(0,this.pageSize):t.slice(0,this.pageSize)}},methods:{close(){this.value?this.showing=!1:this.$router.go(-1)},async itemClicked(t){this.loading=!0,this.callback(t),this.showing=!1,this.loading=!1},onScroll(t){const e=t.target,s=e.scrollTop+e.clientHeight>=e.scrollHeight-e.clientHeight;s&&(this.pageSize+h<this.tokens.length?this.pageSize+=h:this.pageSize=this.tokens.length-1)},show(t){this.callback=t,this.showing=!0},updateSearch(t){this.search=t}}}),m=p,v=s(1001),g=(0,v.Z)(m,r,o,!1,null,null,null),f=g.exports,b=s(61627),k=s(53106),y=n.Z.extend({components:{AssetSelectorDialog:f,ChainBadge:b.Z,TokenIcon:k.Z},props:{options:{type:Array,default:void 0},value:{type:Object,default:void 0},stillLoadingCount:{type:Number,default:0}},data(){return{dialog:!1}},computed:{address(){return"contract"in this.token?this.token.contract.contract:this.token.address},chain(){return this.token.chain},name(){return"contract"in this.token?this.token.contract.name:this.token.name},symbol(){return"contract"in this.token?this.token.contract.symbol:this.token.symbol},token(){return this.value??this.$store.getters.matchingNativeToken("",this.chain)}},methods:{showDialog(){this.$refs.dialog.show((t=>{this.$emit("input",t)}))}}}),w=y,x=(0,v.Z)(w,i,a,!1,null,null,null),_=x.exports},97304:function(t,e,s){"use strict";s.r(e),s.d(e,{default:function(){return A}});var i=function(){var t=this,e=t.$createElement,i=t._self._c||e;return t.token?i("div",[i("top-bar",{attrs:{title:t.$t("general.send"),"test-parent-name":"send_view"}}),i("div",{staticClass:"px-14 py-4"},[i("div",{staticClass:"mb-4 font-bold flex relative"},[t._v(" "+t._s(t.$t("general.recipient"))+" "),i("img",{staticClass:"ml-2.5",attrs:{src:s(92769)},on:{mouseout:t.hideAddressResolversPopover,mouseover:t.showAddressResolversPopover}}),i("simple-popover",{ref:"addressResolversPopover",staticClass:"absolute top-8 left-12 z-10",attrs:{"caret-position":"left-5 top-0.5"}},[i("div",[i("p",{staticClass:"mb-6 font-semibold text-dark-N77"},[t._v(" "+t._s(t.$t("views.sendView.domainNamesSupported"))+" ")]),t._l(t.addressResolvers,(function(e){var a=e[0],n=e[1];return i("div",{key:a,staticClass:"flex items-center space-x-4 mt-4"},[i("img",{attrs:{src:s(61986)("./"+a+".svg"),alt:""}}),i("p",{staticClass:"text-left font-medium"},[t._v(t._s(n))])])}))],2)])],1),i("opera-input",{staticClass:"t-send_view-recipient",attrs:{"test-error-class":"t-send_view-invalid_recipient",error:!t.validRecipient&&t.amountInitialized?t.$t("errors.generic.invalidRecipient"):"",icon:t.recipientInputIcon,"img-url":t.addressResolver?s(61986)("./"+t.addressResolver+".svg"):"",loading:t.resolvingAddress||t.auditingAddress,placeholder:t.$t("general.enterAddressOrDomain"),warning:t.isAddressMalicious?t.$t("warnings.maliciousAddressCheck.warning"):""},nativeOn:{input:function(e){return t.resolveAddress(500)}},model:{value:t.recipient,callback:function(e){t.recipient=e},expression:"recipient"}}),i("p",{directives:[{name:"show",rawName:"v-show",value:!(!t.validRecipient&&t.amountInitialized)&&!t.isAddressMalicious,expression:"!(!validRecipient && amountInitialized) && !isAddressMalicious"}],staticClass:"text-xs text-dark-N77 -mt-4"},[t._v(" "+t._s(t.resolvedAddress)+" ")]),i("br"),i("div",{staticClass:"font-bold mb-4"},[t._v(t._s(t.$t("general.asset")))]),i("asset-selector",{staticClass:"t-send_view-asset mb-2",attrs:{options:t.sendableTokens},model:{value:t.token,callback:function(e){t.token=e},expression:"token"}}),i("div",{staticClass:"text-xs text-dark-N77 t-send_view-token_balance"},[t._v(" "+t._s(t.$t("general.balance"))+": "+t._s(t.fullBalance)+" ")]),i("br"),i("div",{staticClass:"mb-4 flex justify-between items-center"},[i("span",{staticClass:"font-bold"},[t._v(t._s(t.$t("general.amount")))]),i("percentage-buttons",{staticClass:"t-send_view-percentage",attrs:{token:t.token,value:t.amount},on:{change:t.assignNewAmount}})],1),i("opera-input",{staticClass:"t-send_view-amount",attrs:{"test-error-class":"t-send_view-invalid_amount",icon:!t.validAmount&&t.amountInitialized?"icon-error":"",type:"number",placeholder:t.$t("general.amountToSend"),error:!t.validAmount&&t.amountInitialized?t.$t("errors.generic.invalidAmount"):""},model:{value:t.amount,callback:function(e){t.amount=t._n(e)},expression:"amount"}}),i("transition",{attrs:{name:"fade"}},[i("div",{directives:[{name:"show",rawName:"v-show",value:t.errorMessage,expression:"errorMessage"}],staticClass:"text-spectrum-red my-4"},[t._v(" "+t._s(t.errorMessage)+" ")])]),i("div",{staticClass:"bottom-group"},[i("primary-button",{staticClass:"t-send_view-next w-full mx-11",attrs:{loading:t.loading,disabled:t.loading||!t.simpleValid||t.isBtcAmountTooSmall,title:t.$t("general.next")},on:{click:t.next}})],1)],1)],1):t._e()},a=[],n=(s(57658),s(94495)),r=s(70794),o=s(932),l=s(18238),c=s(87307),d=function(){var t=this,e=t.$createElement,s=t._self._c||e;return t.showing?s("div",{staticClass:"t-simple_popover transition-all duration-150 ease-in-out w-10/12",class:[t.opacityClass]},[s("div",{staticClass:"w-full bg-dark-N16 rounded-lg shadow-2xl"},[s("div",{staticClass:"relative p-7.5 pt-6"},[s("div",{staticClass:"absolute h-11 w-11 bg-dark-N16 rotate-45 transform -z-10",class:[t.caretPosition]}),t._t("default")],2)])]):t._e()},u=[],h={name:"SimplePopover",props:{caretPosition:{type:String,required:!0}},data(){return{opacityClass:"opacity-0",showing:!1}},methods:{hide(){this.showing=!1,this.opacityClass="opacity-0"},show(){this.showing=!0,setTimeout((()=>{this.opacityClass="opacity-100"}),100)}}},p=h,m=s(1001),v=(0,m.Z)(p,d,u,!1,null,null,null),g=v.exports,f=s(56258),b=s(74293),k=s(4634),y=s(98180),w=s(35210),x={components:{AssetSelector:n.Z,OperaInput:o.Z,PercentageButtons:l.Z,PrimaryButton:c.Z,SimplePopover:g,TopBar:b.Z},beforeRouteEnter(t,e,s){"SendConfirm"===e.name&&"SendToken"===t.name?s():s((t=>{t.recipient="",t.amount=null,t.token=t.getToken()}))},data(){return{amount:null,error:null,loading:!1,message:"",recipient:"",timer:null,token:null,transaction:null}},computed:{addressResolver(){return this.$store.getters.addressResolver},addressResolvers(){return this.$store.getters.addressResolvers},amountInitialized(){return null!==this.amount},amountWithoutDecimals(){return y.Z.withoutDecimals(this.amount,this.token.contract.decimals)},auditingAddress(){return this.$store.getters.isLoading("addressAudit")},chain(){return this.token.chain},errorMessage(){return this.isBtcAmountTooSmall?this.$t("errors.amountTooSmall"):this.getErrorMessage()},fullBalance(){return this.$store.getters.getFullTokenBalance(this.address,this.token,this.chain)},isAddressMalicious(){return this.$store.getters.isAddressMalicious},isBtcAmountTooSmall(){if(!this.validAmount)return;const t=1e-5;return(0,w.ij)(this.token.chain)&&new r.Z(this.amount).isLessThan(t)},maxAmount(){return y.Z.withDecimals(this.token?.balance||0,this.token.contract?.decimals||0)},nativeTokens(){return this.$store.getters.nativeTokens},recipientAddress(){return this.resolvedAddress||this.recipient},recipientInputIcon(){return!this.validRecipient&&this.amountInitialized?"icon-error":this.isAddressMalicious?"icon-warning":this.addressResolver?"":this.validRecipient?"icon-check_selected":"icon-contacts"},resolvedAddress(){return this.$store.getters.resolvedAddress},resolvingAddress(){return this.$store.getters.isLoading("addressResolver")},sendableTokens(){return this.$store.getters.ownedTokens.filter((t=>(0,r.Z)(t.balance).isGreaterThan(0)))},simpleValid(){return this.validRecipient&&this.validAmount},valid(){return this.validRecipient&&this.validAmount&&this.transaction},validAmount(){return!!this.token&&((0,r.Z)(this.amount).isGreaterThan(0)&&(0,r.Z)(this.amount).isLessThanOrEqualTo(this.maxAmount))},validRecipient(){return this.$store.getters.isAddressValid(this.recipientAddress)&&!this.$store.getters.txError["invalidRecipient"]}},watch:{amount(){this.error=null},resolvedAddress(t){t&&this.$store.dispatch("auditAddress",{address:this.recipientAddress,chain:this.chain})},token(){this.amount=null,this.resolveAddress(100)}},mounted(){f.Z.sendStatsEvent(f.Z.types.IMPRESSION,"wt_send_entered"),this.$store.commit("SET_TX_CHAIN",this.chain)},beforeDestroy(){this.$store.dispatch("clearTxError"),clearTimeout(this.timer)},methods:{getToken(){const t=this.$route.params.token,e=this.$store.getters.enabledNetworks[0].nativeCurrency;return t??e},getErrorMessage(){if(!this.error)return"";const t=this.error,e=[{raw:"insufficient funds",message:this.$t("errors.insufficientFunds")},{raw:"cannot estimate gas",message:this.$t("errors.cannotEstimateGas")},{raw:"ENS: Lookup",message:this.$t("errors.nameResolutionFailed")}],s=e.find((e=>t.includes(e.raw)))?.message;return s??this.$t("errors.generic.unknownError")},async buildTransactionPayload(){const t=k.ZP.removeExponential(this.amountWithoutDecimals).toString(),{contract:e}=this.token,s=(0,r.Z)(this.amount).isEqualTo(this.maxAmount),i={from:this.$store.getters.accountsByCoinType[this.chain.coinType],to:this.recipientAddress,amount:t,token:{address:e.contract,chain:this.chain,symbol:e.symbol},sendMaxAmount:s};return this.$store.getters.matchingNativeToken(e.type)||(i.token.type=e.type),i},async createTransaction(){if(!this.validRecipient||!this.validAmount)return null;try{const t=await this.buildTransactionPayload(),e=await this.$wallet.createTransaction(t);this.transaction=Object.assign(e,{amount:t.amount,from:t.from,to:t.to})}catch(t){this.transaction=null,this.error=t.message||t}return this.transaction},async next(){if(!this.simpleValid||this.loading)return;f.Z.sendStatsEvent(f.Z.types.CLICK,"wt_send_next_suc",{network:this.$store.getters.getNetworkName(this.chain)}),this.loading=!0,this.$progress.show();const t=await this.createTransaction();this.$progress.hide(),t&&!this.error&&this.$router.push({name:"SendConfirm",params:{transaction:this.transaction,token:this.token}}),this.loading=!1},assignNewAmount(t){this.amount=t},resolveAddress(t){!this.resolvingAddress&&this.timer&&(this.$store.dispatch("clearResolvedAddressData"),this.$store.dispatch("clearAddressAuditData")),clearTimeout(this.timer),this.timer=setTimeout((async()=>{const t={address:this.recipientAddress,chain:this.chain};await this.$store.dispatch("resolveAddress",t),await this.$store.dispatch("auditAddress",t)}),t)},hideAddressResolversPopover(){this.$refs.addressResolversPopover.hide()},showAddressResolversPopover(){this.$refs.addressResolversPopover.show()}}},_=x,C=(0,m.Z)(_,i,a,!1,null,"213a976c",null),A=C.exports},61986:function(t,e,s){var i={"./1inch.svg":35815,"./PancakeSwap.svg":11496,"./binancecnt.svg":80818,"./ens.svg":35332,"./fio.svg":27200,"./moonpay.svg":82820,"./ramp.svg":82702,"./ud.svg":68237,"./wyre.svg":97061,"./yat.svg":15418};function a(t){var e=n(t);return s(e)}function n(t){if(!s.o(i,t)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return i[t]}a.keys=function(){return Object.keys(i)},a.resolve=n,t.exports=a,a.id=61986},35815:function(t,e,s){"use strict";t.exports=s.p+"img/1inch.34f8ba63.svg"},11496:function(t,e,s){"use strict";t.exports=s.p+"img/PancakeSwap.94943d6f.svg"},80818:function(t,e,s){"use strict";t.exports=s.p+"img/binancecnt.f04ec441.svg"},35332:function(t,e,s){"use strict";t.exports=s.p+"img/ens.b2f0fdfa.svg"},27200:function(t,e,s){"use strict";t.exports=s.p+"img/fio.83de3eb2.svg"},82820:function(t,e,s){"use strict";t.exports=s.p+"img/moonpay.6b4c9c2a.svg"},82702:function(t,e,s){"use strict";t.exports=s.p+"img/ramp.26a0a8eb.svg"},68237:function(t,e,s){"use strict";t.exports=s.p+"img/ud.8f615537.svg"},97061:function(t,e,s){"use strict";t.exports=s.p+"img/wyre.72783911.svg"},15418:function(t,e,s){"use strict";t.exports=s.p+"img/yat.b2137dfd.svg"},92769:function(t,e,s){"use strict";t.exports=s.p+"img/help.a36d1970.svg"}}]);